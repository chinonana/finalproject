{"filter":false,"title":"GoogleLoginController.php","tooltip":"/finalproject/app/Http/Controllers/GoogleLoginController.php","undoManager":{"mark":10,"position":10,"stack":[[{"start":{"row":4,"column":28},"end":{"row":5,"column":0},"action":"insert","lines":["",""],"id":12}],[{"start":{"row":5,"column":0},"end":{"row":5,"column":36},"action":"insert","lines":["use Illuminate\\Support\\Facades\\Hash;"],"id":13}],[{"start":{"row":5,"column":36},"end":{"row":6,"column":0},"action":"insert","lines":["",""],"id":14}],[{"start":{"row":6,"column":0},"end":{"row":6,"column":36},"action":"insert","lines":["use Illuminate\\Support\\Facades\\Auth;"],"id":15}],[{"start":{"row":7,"column":0},"end":{"row":7,"column":14},"action":"insert","lines":["use Socialite;"],"id":16}],[{"start":{"row":7,"column":14},"end":{"row":8,"column":0},"action":"insert","lines":["",""],"id":17}],[{"start":{"row":8,"column":0},"end":{"row":8,"column":20},"action":"insert","lines":["use App\\Models\\User;"],"id":18}],[{"start":{"row":8,"column":20},"end":{"row":9,"column":0},"action":"insert","lines":["",""],"id":19}],[{"start":{"row":12,"column":6},"end":{"row":13,"column":0},"action":"insert","lines":["",""],"id":20},{"start":{"row":13,"column":0},"end":{"row":13,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":13,"column":4},"end":{"row":45,"column":5},"action":"insert","lines":[" public function redirectToGoogle()","    {","        // Googleへのリダイレクト→Google側で認証処理","        return Socialite::driver('google')->redirect();","    }","","    public function handleGoogleCallback()","    {","        // googleのユーザ情報を取得","        $googleUser = Socialite::driver('google')->stateless()->user();","        // email が合致するユーザをDBから取得","        $user = User::where('email', $googleUser->email)->first();","        // DBに該当するユーザがなければ新しくユーザを作成","        if ($user == null) {","            $user = $this->createUser($googleUser);","        }","","        // 作成したユーザでログイン処理","        Auth::login($user, true);","","        // /homeにリダイレクト","        return redirect('/home');","    }","","    public function createUser($googleUser)","    {","        $user = User::create([","            'name'     => $googleUser->name,","            'email'    => $googleUser->email,","            'password' => Hash::make(uniqid()),","        ]);","        return $user;","    }"],"id":21}],[{"start":{"row":12,"column":4},"end":{"row":13,"column":5},"action":"remove","lines":["//","     "],"id":22}]]},"ace":{"folds":[],"scrolltop":248,"scrollleft":0,"selection":{"start":{"row":16,"column":5},"end":{"row":16,"column":5},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":26,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1630853378039,"hash":"c0321e44513014b91cab4733a0e83c1efebc097a"}